<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… | Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@700&display=swap" rel="stylesheet">
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore-compat.js"></script>
    <style>
        body { font-family: 'Cairo'; background: #000d1a; color: white; padding: 20px; }
        .box { background: rgba(255,255,255,0.05); padding: 15px; border-radius: 15px; border: 1px solid #0056b3; margin-bottom: 20px; }
        input { padding: 8px; border-radius: 5px; border: none; margin: 5px; width: 150px; }
        .btn { background: #28a745; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; }
        .user-item { border-bottom: 1px solid #222; padding: 10px; display: flex; justify-content: space-between; align-items: center; }
    </style>
</head>
<body>
    <h2>ðŸš€ Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ù‡Ø§Ø´Ù…ÙŠ</h2>

    <div class="box">
        <h3>ðŸ“¢ Ø§Ù„ØªØ­ÙƒÙ… Ø¨Ø´Ø±ÙŠØ· Ø§Ù„Ø£Ø³Ø¹Ø§Ø±</h3>
        <input type="text" id="priceInput" style="width: 70%;" placeholder="Ù…Ø«Ø§Ù„: Ø¯ÙˆÙ„Ø§Ø± ØµÙ†Ø¹Ø§Ø¡ 535 | Ø³Ø¹ÙˆØ¯ÙŠ 140">
        <button class="btn" style="background: #ffc107; color: black;" onclick="setPrice()">Ù†Ø´Ø± Ø§Ù„Ø£Ø³Ø¹Ø§Ø±</button>
    </div>

    <div class="box">
        <h3>ðŸ‘¥ Ø§Ù„Ù…ØªØ¯Ø§ÙˆÙ„ÙŠÙ†</h3>
        <div id="list">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>
    </div>

    <script>
        const firebaseConfig = {
          apiKey: "AIzaSyBk8cLXSGB061b9gWL8MON4e82wjDY6SLk",
          authDomain: "al-hashemi-trading.firebaseapp.com",
          projectId: "al-hashemi-trading",
          storageBucket: "al-hashemi-trading.firebasestorage.app",
          messagingSenderId: "953121089418",
          appId: "1:953121089418:web:97ba662c3b71aed6830a73"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        async function setPrice() {
            const text = document.getElementById('priceInput').value;
            await db.collection("settings").doc("prices").set({ text });
            alert("ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø´Ø±ÙŠØ· Ø¹Ù†Ø¯ Ø§Ù„Ø¬Ù…ÙŠØ¹! âœ…");
        }

        db.collection("traders").onSnapshot(s => {
            const div = document.getElementById('list');
            div.innerHTML = '';
            s.forEach(doc => {
                const u = doc.data();
                div.innerHTML += `<div class="user-item">
                    <div>${u.name}<br><small>${u.phone}</small></div>
                    <div>
                        <input type="number" id="b-${doc.id}" value="${u.newBal}">
                        <button class="btn" onclick="update('${doc.id}')">ØªØ¹Ø¯ÙŠÙ„</button>
                    </div>
                </div>`;
            });
        });

        async function update(id) {
            const val = document.getElementById(`b-${id}`).value;
            await db.collection("traders").doc(id).update({ newBal: Number(val) });
        }
    </script>
</body>
</html>
